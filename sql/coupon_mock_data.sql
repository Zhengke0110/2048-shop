# 优惠券模拟数据
# 清空表数据（可选）
# TRUNCATE TABLE coupon;
# TRUNCATE TABLE coupon_record;

# 插入优惠券数据
INSERT INTO `coupon` (
    `id`, `category`, `publish`, `coupon_img`, `coupon_title`, `price`, `user_limit`, 
    `start_time`, `end_time`, `publish_count`, `stock`, `create_time`, `condition_price`,
    `exclude_products`, `min_product_count`, `applicable_categories`, 
    `discount_rate`, `max_discount_amount`, `stackable`, `first_order_only`,
    `receive_start_time`, `receive_end_time`, `daily_limit`, `description`, `usage_rules`,
    `creator_id`, `update_time`, `del_flag`
) VALUES
-- 新用户注册券
(1, 'NEW_USER', 'PUBLISH', 'https://example.com/coupon/new_user.jpg', '新用户专享20元无门槛券', 20.00, 1, 
 '2025-01-01 00:00:00', '2025-12-31 23:59:59', 10000, 8500, '2025-01-01 10:00:00', 0.00,
 NULL, 1, NULL, NULL, NULL, 0, 1,
 '2025-01-01 00:00:00', '2025-12-31 23:59:59', 100, '新用户注册即可领取，无门槛使用', '1.新用户专享;2.无门槛使用;3.不可叠加使用',
 1001, '2025-01-01 10:00:00', 0),

(2, 'NEW_USER', 'PUBLISH', 'https://example.com/coupon/new_user_50.jpg', '新用户专享50元券', 50.00, 1,
 '2025-01-01 00:00:00', '2025-12-31 23:59:59', 5000, 4200, '2025-01-01 10:00:00', 199.00,
 NULL, 1, NULL, NULL, NULL, 0, 1,
 '2025-01-01 00:00:00', '2025-12-31 23:59:59', 50, '新用户注册专享，满199可用', '1.新用户专享;2.满199元可用;3.首单使用',
 1001, '2025-01-01 10:00:00', 0),

-- 任务券
(3, 'TASK', 'PUBLISH', 'https://example.com/coupon/task_sign.jpg', '连续签到7天奖励券', 15.00, 3,
 '2025-07-01 00:00:00', '2025-08-31 23:59:59', 2000, 1800, '2025-06-25 10:00:00', 99.00,
 NULL, 1, '1,2,3', NULL, NULL, 1, 0,
 '2025-07-01 00:00:00', '2025-08-31 23:59:59', 30, '连续签到7天可获得，适用于服装类商品', '1.连续签到7天获得;2.满99元可用;3.可与其他券叠加',
 1001, '2025-06-25 10:00:00', 0),

(4, 'TASK', 'PUBLISH', 'https://example.com/coupon/task_share.jpg', '分享好友奖励券', 10.00, 10,
 '2025-07-01 00:00:00', '2025-09-30 23:59:59', 5000, 4500, '2025-06-25 10:00:00', 50.00,
 '100,101,102', 1, NULL, NULL, NULL, 1, 0,
 '2025-07-01 00:00:00', '2025-09-30 23:59:59', 100, '分享商品给好友可获得，排除特殊商品', '1.分享商品获得;2.满50元可用;3.每人限10张',
 1001, '2025-06-25 10:00:00', 0),

-- 促销券
(5, 'PROMOTION', 'PUBLISH', 'https://example.com/coupon/promotion_summer.jpg', '夏日狂欢100元券', 100.00, 5,
 '2025-07-15 00:00:00', '2025-08-31 23:59:59', 1000, 750, '2025-07-10 09:00:00', 500.00,
 NULL, 2, NULL, NULL, NULL, 0, 0,
 '2025-07-15 00:00:00', '2025-08-31 23:59:59', 20, '夏日狂欢活动专用券，满500可用', '1.夏日活动专用;2.满500元可用;3.最少购买2件商品',
 1002, '2025-07-10 09:00:00', 0),

(6, 'PROMOTION', 'PUBLISH', 'https://example.com/coupon/promotion_rate.jpg', '全场8折券', NULL, 3,
 '2025-07-20 00:00:00', '2025-08-20 23:59:59', 500, 320, '2025-07-18 10:00:00', 200.00,
 NULL, 1, NULL, 20.00, 50.00, 0, 0,
 '2025-07-20 00:00:00', '2025-08-20 23:59:59', 50, '全场商品8折，最高优惠50元', '1.全场8折;2.满200元可用;3.最高优惠50元',
 1002, '2025-07-18 10:00:00', 0),

(7, 'PROMOTION', 'DRAFT', 'https://example.com/coupon/promotion_double11.jpg', '双11预热券', 200.00, 1,
 '2025-11-01 00:00:00', '2025-11-11 23:59:59', 2000, 2000, '2025-07-25 14:00:00', 1000.00,
 NULL, 3, NULL, NULL, NULL, 0, 0,
 '2025-10-25 00:00:00', '2025-11-11 23:59:59', 100, '双11预热活动券，满1000可用', '1.双11活动专用;2.满1000元可用;3.最少购买3件商品',
 1002, '2025-07-25 14:00:00', 0),

-- 已下线的券
(8, 'PROMOTION', 'OFFLINE', 'https://example.com/coupon/promotion_618.jpg', '618购物节券', 80.00, 3,
 '2025-06-01 00:00:00', '2025-06-18 23:59:59', 3000, 0, '2025-05-25 10:00:00', 300.00,
 NULL, 1, '4,5,6', NULL, NULL, 1, 0,
 '2025-06-01 00:00:00', '2025-06-18 23:59:59', 200, '618购物节活动券，已结束', '1.618活动券;2.满300元可用;3.活动已结束',
 1002, '2025-06-19 10:00:00', 0),

-- 新增：保证能成功领取的优惠券
(9, 'PROMOTION', 'PUBLISH', 'https://example.com/coupon/test_success1.jpg', '测试专用优惠券A', 30.00, 10,
 '2025-07-01 00:00:00', '2025-12-31 23:59:59', 1000, 900, '2025-07-01 10:00:00', 100.00,
 NULL, 1, NULL, NULL, NULL, 0, 0,
 '2025-07-01 00:00:00', '2025-12-31 23:59:59', 50, '测试专用优惠券，保证能成功领取', '1.测试专用;2.满100元可用;3.每人限10张',
 1001, '2025-07-01 10:00:00', 0),

(10, 'TASK', 'PUBLISH', 'https://example.com/coupon/test_success2.jpg', '测试专用任务券B', 25.00, 5,
 '2025-07-01 00:00:00', '2025-12-31 23:59:59', 500, 450, '2025-07-01 10:00:00', 80.00,
 NULL, 1, NULL, NULL, NULL, 1, 0,
 '2025-07-01 00:00:00', '2025-12-31 23:59:59', 20, '测试专用任务券，无门槛领取', '1.测试专用;2.满80元可用;3.可叠加使用',
 1001, '2025-07-01 10:00:00', 0),

(11, 'NEW_USER', 'PUBLISH', 'https://example.com/coupon/test_success3.jpg', '测试专用新用户券C', 15.00, 3,
 '2025-07-01 00:00:00', '2025-12-31 23:59:59', 200, 180, '2025-07-01 10:00:00', 0.00,
 NULL, 1, NULL, NULL, NULL, 0, 0,
 '2025-07-01 00:00:00', '2025-12-31 23:59:59', 10, '测试专用新用户券，无门槛使用', '1.测试专用;2.无门槛使用;3.每人限3张',
 1001, '2025-07-01 10:00:00', 0);

# 插入优惠券领取记录数据
INSERT INTO `coupon_record` (
    `id`, `coupon_id`, `create_time`, `use_state`, `user_id`, `user_name`, `coupon_title`,
    `start_time`, `end_time`, `order_id`, `price`, `condition_price`, `use_time`,
    `actual_discount_amount`, `receive_channel`, `share_user_id`, `update_time`, `del_flag`
) VALUES
-- 新用户券使用记录（减少一些记录，让ID=1券能再次领取）
(1, 1, '2025-07-20 10:30:00', 'USED', 339416063609409536, '测试用户', '新用户专享20元无门槛券',
 '2025-01-01 00:00:00', '2025-12-31 23:59:59', 10001, 20.00, 0.00, '2025-07-21 15:20:00',
 20.00, 'AUTO', NULL, '2025-07-21 15:20:00', 0),

(2, 2, '2025-07-19 14:20:00', 'USED', 339416063609409536, '测试用户', '新用户专享50元券',
 '2025-01-01 00:00:00', '2025-12-31 23:59:59', 10002, 50.00, 199.00, '2025-07-20 09:15:00',
 50.00, 'AUTO', NULL, '2025-07-20 09:15:00', 0),

-- 任务券记录（减少签到券记录，让ID=3券能再次领取）
(4, 3, '2025-07-15 08:00:00', 'USED', 339416063609409536, '测试用户', '连续签到7天奖励券',
 '2025-07-01 00:00:00', '2025-08-31 23:59:59', 10003, 15.00, 99.00, '2025-07-16 20:30:00',
 15.00, 'ACTIVITY', NULL, '2025-07-16 20:30:00', 0),

(5, 4, '2025-07-18 12:30:00', 'NEW', 339416063609409536, '测试用户', '分享好友奖励券',
 '2025-07-01 00:00:00', '2025-09-30 23:59:59', NULL, 10.00, 50.00, NULL,
 NULL, 'SHARE', 339416063609409536, '2025-07-18 12:30:00', 0),

(6, 4, '2025-07-19 15:20:00', 'NEW', 339416063609409536, '测试用户', '分享好友奖励券',
 '2025-07-01 00:00:00', '2025-09-30 23:59:59', NULL, 10.00, 50.00, NULL,
 NULL, 'SHARE', 339416063609409536, '2025-07-19 15:20:00', 0),

-- 促销券记录（只保留一条夏日券记录）
(7, 5, '2025-07-16 10:00:00', 'USED', 339416063609409536, '测试用户', '夏日狂欢100元券',
 '2025-07-15 00:00:00', '2025-08-31 23:59:59', 10004, 100.00, 500.00, '2025-07-17 11:45:00',
 100.00, 'ACTIVITY', NULL, '2025-07-17 11:45:00', 0),

-- 过期券记录
(10, 8, '2025-06-05 10:20:00', 'EXPIRED', 339416063609409536, '测试用户', '618购物节券',
 '2025-06-01 00:00:00', '2025-06-18 23:59:59', NULL, 80.00, 300.00, NULL,
 NULL, 'ACTIVITY', NULL, '2025-06-19 00:00:01', 0);

# 查询统计信息
SELECT 
    '优惠券统计' as type,
    category,
    publish,
    COUNT(*) as count,
    SUM(publish_count) as total_publish,
    SUM(stock) as total_stock
FROM coupon 
GROUP BY category, publish

UNION ALL

SELECT 
    '领取记录统计' as type,
    use_state as category,
    receive_channel as publish,
    COUNT(*) as count,
    NULL as total_publish,
    NULL as total_stock
FROM coupon_record 
GROUP BY use_state, receive_channel
ORDER BY type, category;
